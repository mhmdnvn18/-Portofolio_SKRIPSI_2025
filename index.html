<!DOCTYPE html>
<html lang="en">
<head>
  <!--
    Halaman utama website perbandingan data TTN & Chirpstack.
    Menyediakan tampilan tabel, summary, grafik, dan fitur export grafik.
    Menggunakan Chart.js untuk visualisasi.
  -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data TTN DHT11</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f7f9fa;
    }

    /* Hindari container bertumpuk pada flex utama */
    .main-flex {
      flex-direction: row !important;
      align-items: flex-start !important;
      justify-content: center !important;
      flex-wrap: wrap;
      gap: 1.5em;
      width: 100%;
      max-width: 1400px;
      margin: 1em auto;
      padding: 1em;
    }

    /* Container perbandingan dan data berdampingan, tidak bertumpuk */
    #compare-container {
      width: 100%;
      max-width: 1200px !important;
      min-width: 600px !important;
      margin-bottom: 1.5em;
      margin-left: auto;
      margin-right: auto;
    }

    .data-containers-flex {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5em;
      justify-content: center;
      width: 100%;
      align-items: flex-start;
    }

    .container {
      flex: 1 1 400px;
      min-width: 300px;
      max-width: 600px;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      padding: 1.5em;
      margin: 0.5em;
      transition: box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      min-height: 700px;
    }

    .container:hover {
      box-shadow: 0 4px 24px rgba(0,0,0,0.13);
    }

    h1 {
      margin-top: 0;
      font-size: 1.8em;
      letter-spacing: 1px;
      color: #2d3a4b;
      text-align: center;
      background: #eaf3fb;
      border-radius: 8px;
      padding: 0.6em 0;
      margin-bottom: 1em;
      border: 1px solid #e3e8ee;
    }

    /* --- Konsistensi controls --- */
    .controls {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 1em;
      margin-bottom: 1.5em;
      background: #f7fafd;
      border-radius: 8px;
      padding: 1.2em;
      border: 1px solid #e3e8ee;
    }

    .controls-row {
      display: flex;
      align-items: center;
      gap: 1em;
      flex-wrap: wrap;
      justify-content: space-between;
      width: 100%;
    }

    label {
      font-weight: bold;
      color: #2d3a4b;
      margin-bottom: 0;
    }

    select {
      flex: 1 1 250px;
      min-width: 200px;
      max-width: 400px;
      width: 100%;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #bfc9d1;
      font-size: 1em;
      background: #f9fbfc;
    }

    button {
      flex: 0 0 auto;
      padding: 10px 20px;
      border-radius: 6px;
      border: none;
      background: #2d8cf0;
      color: #fff;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s;
    }

    button:hover {
      background: #1766b3;
      box-shadow: 0 2px 8px rgba(45,140,240,0.13);
    }

    #fileName, #csvFileName {
      margin-left: 1em;
      color: #888;
      font-size: 0.95em;
      font-style: italic;
    }

    /* --- Konsistensi summary-cards --- */
    .summary-cards {
      display: flex;
      gap: 1.2em;
      flex-wrap: wrap;
      justify-content: flex-start;
      margin: 0 0 2em 0;
      padding: 0 0.5em;
      row-gap: 1em;
    }

    .card {
      background: #f3f7fa;
      border-radius: 10px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.04);
      padding: 1.2em;
      min-width: 160px;
      text-align: center;
      border: 1px solid #e3e8ee;
      flex: 1 1 180px;
    }

    .card-title {
      font-size: 0.95em;
      color: #3a4a5d;
      margin-bottom: 0.3em;
    }

    .card-value {
      font-size: 1.6em;
      font-weight: bold;
      color: #2d8cf0;
    }

    .table-container {
      overflow-x: auto;
      width: 100%;
      margin: 1em 0;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    }

    table {
      border-collapse: collapse;
      width: 100%;
      background: #fff;
      min-width: 1100px;
      /* margin-top: 12px; bisa dihapus jika tidak diperlukan */
    }

    th, td {
      border: 1px solid #e3e8ee;
      padding: 8px 10px;
      text-align: left;
      min-width: 80px;
    }

    /* Membuat kolom waktu pada tabel TTN lebih lebar */
    #data-table th:nth-child(2),
    #data-table td:nth-child(2) {
      min-width: 120px;
      /* atau gunakan width: 180px; jika ingin fixed */
    }

    /* Ukuran kolom tabel data TTN DHT11 */
    #data-table th:nth-child(1), #data-table td:nth-child(1) { min-width: 40px; max-width: 50px; }
    #data-table th:nth-child(2), #data-table td:nth-child(2) { min-width: 160px; max-width: 200px; }
    #data-table th:nth-child(3), #data-table td:nth-child(3) { min-width: 110px; max-width: 140px; }
    #data-table th:nth-child(4), #data-table td:nth-child(4) { min-width: 90px; max-width: 120px; }
    #data-table th:nth-child(5), #data-table td:nth-child(5) { min-width: 140px; max-width: 180px; }
    #data-table th:nth-child(6), #data-table td:nth-child(6) { min-width: 110px; max-width: 140px; }
    #data-table th:nth-child(7), #data-table td:nth-child(7) { min-width: 80px; max-width: 90px; }
    #data-table th:nth-child(8), #data-table td:nth-child(8) { min-width: 100px; max-width: 110px; }
    #data-table th:nth-child(9), #data-table td:nth-child(9) { min-width: 70px; max-width: 90px; }
    #data-table th:nth-child(10), #data-table td:nth-child(10) { min-width: 70px; max-width: 90px; }
    #data-table th:nth-child(11), #data-table td:nth-child(11) { min-width: 90px; max-width: 110px; }
    #data-table th:nth-child(12), #data-table td:nth-child(12) { min-width: 60px; max-width: 70px; }
    #data-table th:nth-child(13), #data-table td:nth-child(13) { min-width: 60px; max-width: 70px; }
    #data-table th:nth-child(14), #data-table td:nth-child(14) { min-width: 160px; max-width: 220px; } /* Coding Rate lebih lebar */
    #data-table th:nth-child(15), #data-table td:nth-child(15) { min-width: 90px; max-width: 110px; }
    #data-table th:nth-child(16), #data-table td:nth-child(16) { min-width: 60px; max-width: 70px; }

    /* Ukuran kolom tabel Chirpstack CSV */
    #csv-table th:nth-child(1), #csv-table td:nth-child(1) { min-width: 40px; max-width: 60px; }      /* id */
    #csv-table th:nth-child(2), #csv-table td:nth-child(2) { min-width: 160px; max-width: 200px; }    /* timestamp */
    #csv-table th:nth-child(3), #csv-table td:nth-child(3) { min-width: 110px; max-width: 140px; }    /* device */
    #csv-table th:nth-child(4), #csv-table td:nth-child(4) { min-width: 100px; max-width: 110px; }    /* temperature */
    #csv-table th:nth-child(5), #csv-table td:nth-child(5) { min-width: 100px; max-width: 110px; }    /* humidity */
    #csv-table th:nth-child(6), #csv-table td:nth-child(6) { min-width: 80px; max-width: 90px; }      /* rssi */
    #csv-table th:nth-child(7), #csv-table td:nth-child(7) { min-width: 80px; max-width: 90px; }      /* snr */
    #csv-table th:nth-child(8), #csv-table td:nth-child(8) { min-width: 90px; max-width: 110px; }     /* frequency */
    #csv-table th:nth-child(9), #csv-table td:nth-child(9) { min-width: 130px; max-width: 180px; }    /* spreading_factor lebih lebar */
    #csv-table th:nth-child(10), #csv-table td:nth-child(10) { min-width: 130px; max-width: 180px; }  /* bandwidth lebih lebar */
    #csv-table th:nth-child(11), #csv-table td:nth-child(11) { min-width: 140px; max-width: 180px; }  /* dev_eui */
    #csv-table th:nth-child(12), #csv-table td:nth-child(12) { min-width: 120px; max-width: 200px; }  /* payload */

    /* Modal warning styles */
    .modal-warning {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0; top: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.25);
      justify-content: center;
      align-items: center;
    }
    .modal-warning.active {
      display: flex;
    }
    .modal-warning-content {
      background: #fffbe8;
      border: 2px solid #f5c542;
      border-radius: 10px;
      padding: 2em 2.5em 1.5em 2.5em;
      box-shadow: 0 6px 32px rgba(0,0,0,0.18);
      text-align: center;
      max-width: 90vw;
      min-width: 260px;
      color: #7a5a00;
      font-size: 1.1em;
      position: relative;
    }
    .modal-warning-content .modal-warning-title {
      font-size: 1.25em;
      font-weight: bold;
      margin-bottom: 0.7em;
      color: #b07d00;
    }
    .modal-warning-content .modal-warning-close {
      position: absolute;
      top: 0.7em;
      right: 1em;
      background: none;
      border: none;
      font-size: 1.5em;
      color: #b07d00;
      cursor: pointer;
      transition: color 0.2s;
    }
    .modal-warning-content .modal-warning-close:hover {
      color: #e67c00;
    }
    .modal-warning-content .modal-warning-btn {
      margin-top: 1.2em;
      padding: 0.6em 1.5em;
      background: #f5c542;
      color: #7a5a00;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    .modal-warning-content .modal-warning-btn:hover {
      background: #ffe08a;
    }
    @media (max-width: 500px) {
      .modal-warning-content {
        padding: 1.2em 0.7em 1em 0.7em;
        font-size: 1em;
      }
    }
  </style>
  <!-- Tambahkan Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Tambahkan Chart.js datalabels CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
</head>
<body>
    <!-- Header: Kontainer utama aplikasi -->
    <header>
      <!--
        main-flex: Layout utama, membagi area perbandingan dan area data TTN/CSV
      -->
      <div class="main-flex">
        <!--
          Container perbandingan: berisi kontrol pemilihan file, summary cards, tabel statistik, dan grafik
        -->
        <div class="container" id="compare-container">
          <h1 style="margin-bottom:0.7em;">Perbandingan Data TTN & Chirpstack</h1>
          <!-- Compare controls: rapikan isi controls-row -->
          <div class="controls" id="compare-controls">
            <div class="controls-row">
              <label for="compare-ttn-select">TTN:</label>
              <select id="compare-ttn-select" aria-label="Pilih file TTN untuk dibandingkan" tabindex="1">
                <option value="">[Semua]</option>
              </select>
              <label for="compare-csv-select">Chirpstack:</label>
              <select id="compare-csv-select" aria-label="Pilih file Chirpstack untuk dibandingkan" tabindex="2">
                <option value="">[Semua]</option>
              </select>
              <button id="compare-btn" type="button" aria-label="Bandingkan data TTN dan Chirpstack" tabindex="3">Bandingkan</button>
            </div>
          </div>
          <div class="summary-cards" id="compare-summary-cards" style="margin-bottom:1.2em;">
            <!--
              Kartu ringkasan statistik perbandingan (PDR, RSSI, SNR, SF)
            -->
            <div class="card">
              <span class="card-icon" style="font-size:1.3em;" aria-label="PDR" title="Packet Delivery Ratio">📦</span>
              <div class="card-title">PDR (%)</div>
              <div id="compare-pdr" class="card-value" style="font-size:1.2em;line-height:1.3;">-</div>
            </div>
            <div class="card">
              <span class="card-icon" style="font-size:1.3em;">📶</span>
              <div class="card-title">RSSI (rata-rata ± std dev, dBm)</div>
              <div id="compare-rssi" class="card-value" style="font-size:1.2em;line-height:1.3;">-</div>
            </div>
            <div class="card">
              <span class="card-icon" style="font-size:1.3em;">📡</span>
              <div class="card-title">SNR (rata-rata ± std dev, dB)</div>
              <div id="compare-snr" class="card-value" style="font-size:1.2em;line-height:1.3;">-</div>
            </div>
            <div class="card">
              <span class="card-icon" style="font-size:1.3em;">🔀</span>
              <div class="card-title">Distribusi SF (%)</div>
              <div id="compare-sf" class="card-value" style="font-size:1em;white-space:pre-line;line-height:1.3;">-</div>
            </div>
          </div>
          <div style="margin-top:0.5em; background:#f7fafd; border-radius:8px; border:1px solid #e3e8ee; padding:1em;">
            <!--
              Statistik deskriptif keseluruhan, distribusi SF, tabel interval, dan grafik
            -->
            <b style="font-size:1.08em; display:block; margin-bottom:0.8em;">Statistik Deskriptif Keseluruhan</b>
            <div style="font-size:0.99em;">
              <div class="compare-table-scroll">
                <table id="compare-stats-table">
                  <caption style="position:absolute;left:-9999px;">Tabel statistik perbandingan TTN dan Chirpstack</caption>
                  <thead>
                    <tr>
                      <th>Metric</th>
                      <th>TTN</th>
                      <th>ChirpStack</th>
                    </tr>
                  </thead>
                  <tbody id="compare-stats-tbody">
                    <!-- Akan diisi oleh JS -->
                  </tbody>
                </table>
              </div>
              <!-- Pisahkan tombol export dan canvas untuk masing-masing metrik -->
              <div style="margin-top:0.7em;">
                <button type="button" onclick="exportChart('overallPDRChart', 'Statistik_Deskriptif_PDR.png')" style="margin-bottom:0.5em;">Export Grafik PDR Keseluruhan</button>
                <canvas id="overallPDRChart" height="100" aria-label="Grafik PDR Keseluruhan" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
              </div>
              <div style="margin-top:0.7em;">
                <button type="button" onclick="exportChart('overallRSSIChart', 'Statistik_Deskriptif_RSSI.png')" style="margin-bottom:0.5em;">Export Grafik RSSI Rata-rata Keseluruhan</button>
                <canvas id="overallRSSIChart" height="100" aria-label="Grafik RSSI Rata-rata Keseluruhan" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
              </div>
              <div style="margin-top:0.7em;">
                <button type="button" onclick="exportChart('overallSNRChart', 'Statistik_Deskriptif_SNR.png')" style="margin-bottom:0.5em;">Export Grafik SNR Rata-rata Keseluruhan</button>
                <canvas id="overallSNRChart" height="100" aria-label="Grafik SNR Rata-rata Keseluruhan" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
              </div>
              <div style="margin-top:1.2em;" class="compare-table-scroll">
                <b>Distribusi Spreading Factor Keseluruhan</b>
                <table id="compare-sf-table" style="margin-top:0.8em;">
                  <caption style="position:absolute;left:-9999px;">Tabel distribusi Spreading Factor TTN dan Chirpstack</caption>
                  <thead>
                    <tr>
                      <th>Platform</th>
                      <th>SF7</th>
                      <th>SF8</th>
                      <th>SF10</th>
                    </tr>
                  </thead>
                  <tbody id="compare-sf-tbody">
                    <!-- Akan diisi oleh JS -->
                  </tbody>
                </table>
                <!-- Tambahkan tombol export dan canvas untuk Distribusi SF Keseluruhan -->
                <div style="margin-top:0.7em;">
                  <button type="button" onclick="exportChart('overallSFChart', 'Distribusi_SF_Keseluruhan.png')" style="margin-bottom:0.5em;">Export Grafik Distribusi SF Keseluruhan</button>
                  <canvas id="overallSFChart" height="120" aria-label="Grafik Distribusi SF Keseluruhan" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
                </div>
              </div>
              <!-- TABEL BARU: Statistik Per Interval -->
              <div style="margin-top:1.8em" class="compare-table-scroll">
                <b>Statistik Deskriptif per Interval</b>
                <table id="compare-interval-table" style="margin-top:0.8em;">
                  <caption style="position:absolute;left:-9999px;">Tabel statistik per interval TTN dan Chirpstack</caption>
                  <thead>
                    <tr>
                      <th>Interval (detik)</th>
                      <th>PDR TTN (%)</th>
                      <th>PDR ChirpStack (%)</th>
                      <th>RSSI TTN (±std)</th>
                      <th>RSSI ChirpStack (±std)</th>
                      <th>SNR TTN (±std)</th>
                      <th>SNR ChirpStack (±std)</th>
                      <th>Jumlah Data TTN</th>
                      <th>Jumlah Data ChirpStack</th>
                    </tr>
                  </thead>
                  <tbody id="compare-interval-tbody">
                    <!-- Akan diisi oleh JS -->
                  </tbody>
                </table>
                <!-- Tambahkan tabel distribusi SF per interval -->
                <div style="margin-top:1.5em;">
                  <b>Distribusi Spreading Factor per Interval</b>
                  <table id="compare-sf-interval-table" style="margin-top:0.8em;">
                    <caption style="position:absolute;left:-9999px;">Tabel distribusi SF per interval TTN dan Chirpstack</caption>
                    <thead>
                      <tr>
                        <th>Interval (detik)</th>
                        <th>Platform</th>
                        <th>SF7</th>
                        <th>SF8</th>
                        <th>SF10</th>
                      </tr>
                    </thead>
                    <tbody id="compare-sf-interval-tbody">
                      <!-- Akan diisi oleh JS -->
                    </tbody>
                  </table>
                  <!-- Tambahkan tombol dan canvas untuk grafik SF per interval -->
                  <div style="margin-top:1.5em;">
                    <button type="button" onclick="exportChart('sfChart', 'Distribusi_Spreading_Factor_per_Interval.png')" style="margin-bottom:0.5em;">Export Grafik Distribusi SF per Interval</button>
                    <canvas id="sfChart" height="140" aria-label="Grafik Distribusi SF TTN vs Chirpstack" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
                  </div>
                </div>
                <!-- Tambahkan tombol dan canvas untuk diagram PDR -->
                <div style="margin-top:1.5em;">
                  <button type="button" onclick="exportChart('pdrChart', 'PDR_per_Interval.png')" style="margin-bottom:0.5em;">Export Grafik PDR per Interval</button>
                  <canvas id="pdrChart" height="110" aria-label="Diagram PDR TTN vs Chirpstack" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
                </div>
                <div style="margin-top:1.5em;">
                  <button type="button" onclick="exportChart('rssiChart', 'RSSI_per_Interval.png')" style="margin-bottom:0.5em;">Export Grafik RSSI per Interval</button>
                  <canvas id="rssiChart" height="110" aria-label="Diagram RSSI TTN vs Chirpstack" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
                </div>
                <div style="margin-top:1.5em;">
                  <button type="button" onclick="exportChart('snrChart', 'SNR_per_Interval.png')" style="margin-bottom:0.5em;">Export Grafik SNR per Interval</button>
                  <canvas id="snrChart" height="110" aria-label="Diagram SNR TTN vs Chirpstack" style="background:#fff;border-radius:8px;box-shadow:0 1px 4px rgba(0,0,0,0.04);"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="data-containers-flex">
          <!--
            Container data TTN dan Chirpstack CSV (masing-masing tabel & summary)
          -->
          <!-- TTN Container -->
          <div class="container">
            <h1>Data TTN DHT11</h1>
            <div class="controls">
              <div class="controls-row">
                <label for="jsonList">Pilih file JSON yang tersedia:</label>
                <select id="jsonList" multiple size="5" aria-label="Pilih file JSON TTN" tabindex="4"></select>
                <button id="loadSelected" type="button" aria-label="Tampilkan Data TTN" tabindex="5">Tampilkan Data</button>
                <span id="fileName"></span>
              </div>
            </div>
            <div class="summary-cards" id="ttn-summary-cards">
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">🌡️</span>
                <div class="card-title">Avg. Temperature</div>
                <div id="avg-temp" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">💧</span>
                <div class="card-title">Avg. Humidity</div>
                <div id="avg-hum" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">📶</span>
                <div class="card-title">Signal Quality</div>
                <div id="avg-rssi" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">❗</span>
                <div class="card-title">Error Rate</div>
                <div id="err-rate" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">⏱️</span>
                <div class="card-title">Waktu Mulai</div>
                <div id="start-time" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">⏲️</span>
                <div class="card-title">Waktu Akhir</div>
                <div id="end-time" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">⏳</span>
                <div class="card-title">Total Waktu</div>
                <div id="total-time" class="card-value">-</div>
              </div>
            </div>
            <div class="section-divider"></div>
            <span id="ttn-data-count" class="data-count-badge" style="display:none"></span>
            <div class="table-container">
              <!-- Hapus <div class="table-scroll-x"> -->
              <table id="data-table">
                <thead>
                  <tr>
                    <th>No</th>
                    <th>Waktu</th>
                    <th>Device ID</th>
                    <th>App ID</th>
                    <th>Dev EUI</th>
                    <th>Dev Addr</th>
                    <th>Humidity</th>
                    <th>Temperature</th>
                    <th>RSSI</th>
                    <th>SNR</th>
                    <th>Frequency</th>
                    <th>SF</th>
                    <th>BW</th>
                    <th>Coding Rate</th>
                    <th>AirTime</th>
                    <th>f_cnt</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Data akan diisi di sini -->
                </tbody>
              </table>
              <!-- </div> -->
            </div>
          </div>

          <!-- Chirpstack CSV Container -->
          <div class="container">
            <h1>Data Chirpstack CSV</h1>
            <div class="controls">
              <div class="controls-row">
                <label for="csvList">Pilih file CSV Chirpstack:</label>
                <select id="csvList" multiple size="5" aria-label="Pilih file CSV Chirpstack" tabindex="6"></select>
                <button id="loadCsv" type="button" aria-label="Tampilkan Data CSV Chirpstack" tabindex="7">Tampilkan Data CSV</button>
                <span id="csvFileName"></span>
              </div>
            </div>
            <div class="summary-cards" id="csv-summary-cards">
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">🌡️</span>
                <div class="card-title">Avg. Temperature</div>
                <div id="csv-avg-temp" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">💧</span>
                <div class="card-title">Avg. Humidity</div>
                <div id="csv-avg-hum" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">📶</span>
                <div class="card-title">Signal Quality</div>
                <div id="csv-avg-rssi" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">❗</span>
                <div class="card-title">Error Rate</div>
                <div id="csv-err-rate" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">⏱️</span>
                <div class="card-title">Waktu Mulai</div>
                <div id="csv-start-time" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">⏲️</span>
                <div class="card-title">Waktu Akhir</div>
                <div id="csv-end-time" class="card-value">-</div>
              </div>
              <div class="card">
                <span class="card-icon" style="font-size:1.3em;">⏳</span>
                <div class="card-title">Total Waktu</div>
                <div id="csv-total-time" class="card-value">-</div>
              </div>
            </div>
            <div class="section-divider"></div>
            <span id="csv-data-count" class="data-count-badge" style="display:none"></span>
            <div class="table-container">
              <table id="csv-table">
                <thead>
                  <tr>
                    <th>id</th>
                    <th>timestamp</th>
                    <th>device</th>
                    <th>temperature</th>
                    <th>humidity</th>
                    <th>rssi</th>
                    <th>snr</th>
                    <th>frequency</th>
                    <th>spreading_factor</th>
                    <th>bandwidth</th>
                    <th>dev_eui</th>
                    <th>payload</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Table will di-render di sini oleh JS -->
                </tbody>
              </table>
              <div id="csv-table-container"></div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <main>
        <!--
          Bagian main: placeholder untuk konten tambahan/statistik lain jika diperlukan
        -->
        <section class="metrics-container">
          <!-- Konten statistik dan metrik utama, jika ada -->
        </section>
        <section>
          <!-- Konten perbandingan data TTN dan Chirpstack -->
        </section>
        <section>
          <!-- Konten detail data TTN -->
        </section>
        <section class="files-section">
          <!-- Konten pemilihan dan tampilan file JSON/CSV -->
        </section>
      </main>
    <!-- Modal warning -->
    <div class="modal-warning" id="modal-warning">
      <div class="modal-warning-content">
        <button class="modal-warning-close" id="modal-warning-close" aria-label="Tutup">&times;</button>
        <div class="modal-warning-title" id="modal-warning-title">Peringatan</div>
        <div id="modal-warning-message">Pesan peringatan di sini.</div>
        <button class="modal-warning-btn" id="modal-warning-btn">OK</button>
      </div>
    </div>
    <script src="main.js"></script>
    <script>
      // Modal warning logic: menampilkan dan menyembunyikan modal warning
      function showModalWarning(message, title = "Peringatan") {
        document.getElementById('modal-warning-title').textContent = title;
        document.getElementById('modal-warning-message').textContent = message;
        document.getElementById('modal-warning').classList.add('active');
      }
      function hideModalWarning() {
        document.getElementById('modal-warning').classList.remove('active');
      }
      document.getElementById('modal-warning-close').onclick = hideModalWarning;
      document.getElementById('modal-warning-btn').onclick = hideModalWarning;

      // Gantikan alert pada main.js dengan showModalWarning
      // Contoh: showModalWarning('Pilih setidaknya satu file JSON');
      // Untuk integrasi, di main.js ganti alert('...') dengan showModalWarning('...');
      // Fungsi untuk menggambar diagram PDR, RSSI, SNR
      function renderPDRChart(intervals, ttnPdr, csvPdr) {
        if (window.pdrChartObj) window.pdrChartObj.destroy();
        const ctx = document.getElementById('pdrChart').getContext('2d');
        window.pdrChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: intervals,
            datasets: [
              {
                label: 'TTN',
                data: ttnPdr,
                backgroundColor: '#2d8cf0'
              },
              {
                label: 'Chirpstack',
                data: csvPdr,
                backgroundColor: '#f5c542'
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Perbandingan PDR (%) TTN vs Chirpstack per Interval' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: {
              y: { beginAtZero: true, max: 100, title: { display: true, text: 'PDR (%)' } }
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      function renderRSSIChart(intervals, ttnRssi, csvRssi) {
        if (window.rssiChartObj) window.rssiChartObj.destroy();
        const ctx = document.getElementById('rssiChart').getContext('2d');
        window.rssiChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: intervals,
            datasets: [
              {
                label: 'TTN',
                data: ttnRssi,
                backgroundColor: '#2d8cf0'
              },
              {
                label: 'Chirpstack',
                data: csvRssi,
                backgroundColor: '#f5c542'
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Perbandingan RSSI (dBm) TTN vs Chirpstack per Interval' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: {
              y: { beginAtZero: false, title: { display: true, text: 'RSSI (dBm)' } }
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      function renderSNRChart(intervals, ttnSnr, csvSnr) {
        if (window.snrChartObj) window.snrChartObj.destroy();
        const ctx = document.getElementById('snrChart').getContext('2d');
        window.snrChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: intervals,
            datasets: [
              {
                label: 'TTN',
                data: ttnSnr,
                backgroundColor: '#2d8cf0'
              },
              {
                label: 'Chirpstack',
                data: csvSnr,
                backgroundColor: '#f5c542'
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Perbandingan SNR (dB) TTN vs Chirpstack per Interval' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: {
              y: { beginAtZero: false, title: { display: true, text: 'SNR (dB)' } }
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      // Grafik Distribusi SF per interval
      function renderSFChart(intervals, ttnSF7, ttnSF8, ttnSF10, csvSF7, csvSF8, csvSF10) {
        if (window.sfChartObj) window.sfChartObj.destroy();
        const ctx = document.getElementById('sfChart').getContext('2d');
        window.sfChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: intervals,
            datasets: [
              {
                label: 'TTN SF7',
                data: ttnSF7,
                backgroundColor: '#2d8cf0'
              },
              {
                label: 'TTN SF8',
                data: ttnSF8,
                backgroundColor: '#8cd0fa'
              },
              {
                label: 'TTN SF10',
                data: ttnSF10,
                backgroundColor: '#b0e0ff'
              },
              {
                label: 'Chirpstack SF7',
                data: csvSF7,
                backgroundColor: '#f5c542'
              },
              {
                label: 'Chirpstack SF8',
                data: csvSF8,
                backgroundColor: '#ffe08a'
              },
              {
                label: 'Chirpstack SF10',
                data: csvSF10,
                backgroundColor: '#ffeec2'
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Distribusi Frame per Spreading Factor (SF) per Interval' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: {
              y: { beginAtZero: true, title: { display: true, text: 'Jumlah Frame' } }
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      // Fungsi export grafik Chart.js ke PNG
      function exportChart(canvasId, filename) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = filename;
        link.click();
      }
      // Hook ke updateCompareIntervalTable di main.js
      if (typeof window.updatePDRChartFromTable !== 'function') {
        window.updatePDRChartFromTable = function(rows) {
          // rows: array of HTML string <tr>...</tr>
          // Ekstrak data dari rows
          const parser = new DOMParser();
          const intervals = [], ttnPdr = [], csvPdr = [], ttnRssi = [], csvRssi = [], ttnSnr = [], csvSnr = [];
          rows.forEach(rowHtml => {
            const doc = parser.parseFromString('<table><tbody>' + rowHtml + '</tbody></table>', 'text/html');
            const tds = doc.querySelectorAll('td');
            if (tds.length >= 7) {
              intervals.push(tds[0].textContent.trim());
              ttnPdr.push(Number(tds[1].textContent.trim()) || 0);
              csvPdr.push(Number(tds[2].textContent.trim()) || 0);
              // RSSI kolom 3 dan 4, format: "nilai ± std"
              const ttnRssiVal = parseFloat((tds[3].textContent.trim().split('±')[0] || '').replace(',', '.'));
              const csvRssiVal = parseFloat((tds[4].textContent.trim().split('±')[0] || '').replace(',', '.'));
              ttnRssi.push(isNaN(ttnRssiVal) ? null : ttnRssiVal);
              csvRssi.push(isNaN(csvRssiVal) ? null : csvRssiVal);
              // SNR kolom 5 dan 6, format: "nilai ± std"
              const ttnSnrVal = parseFloat((tds[5].textContent.trim().split('±')[0] || '').replace(',', '.'));
              const csvSnrVal = parseFloat((tds[6].textContent.trim().split('±')[0] || '').replace(',', '.'));
              ttnSnr.push(isNaN(ttnSnrVal) ? null : ttnSnrVal);
              csvSnr.push(isNaN(csvSnrVal) ? null : csvSnrVal);
            }
          });
          renderPDRChart(intervals, ttnPdr, csvPdr);
          renderRSSIChart(intervals, ttnRssi, csvRssi);
          renderSNRChart(intervals, ttnSnr, csvSnr);

          // Ambil data SF dari tabel distribusi SF per interval
          const sfTable = document.getElementById('compare-sf-interval-tbody');
          if (sfTable) {
            const sfRows = Array.from(sfTable.querySelectorAll('tr'));
            // Data: urutannya [TTN, Chirpstack, TTN, Chirpstack, ...] per interval
            const ttnSF7 = [], ttnSF8 = [], ttnSF10 = [], csvSF7 = [], csvSF8 = [], csvSF10 = [], sfIntervals = [];
            for (let i = 0; i < sfRows.length; i += 2) {
              // TTN row
              const ttnTds = sfRows[i].querySelectorAll('td');
              // Chirpstack row
              const csvTds = sfRows[i + 1]?.querySelectorAll('td');
              if (ttnTds.length >= 5 && csvTds && csvTds.length >= 5) {
                sfIntervals.push(ttnTds[0].textContent.trim());
                ttnSF7.push(Number((ttnTds[2].textContent.trim().split('(')[0] || '0').replace(',', '.')));
                ttnSF8.push(Number((ttnTds[3].textContent.trim().split('(')[0] || '0').replace(',', '.')));
                ttnSF10.push(Number((ttnTds[4].textContent.trim().split('(')[0] || '0').replace(',', '.')));
                csvSF7.push(Number((csvTds[2].textContent.trim().split('(')[0] || '0').replace(',', '.')));
                csvSF8.push(Number((csvTds[3].textContent.trim().split('(')[0] || '0').replace(',', '.')));
                csvSF10.push(Number((csvTds[4].textContent.trim().split('(')[0] || '0').replace(',', '.')));
              }
            }
            renderSFChart(sfIntervals, ttnSF7, ttnSF8, ttnSF10, csvSF7, csvSF8, csvSF10);
          }
        };
      }
      // Grafik Statistik Deskriptif Keseluruhan
      function renderOverallStatsChart() {
        const canvas = document.getElementById('overallStatsChart');
        if (!canvas) {
          console.warn('Canvas #overallStatsChart tidak ditemukan');
          return;
        }
        const ctx = canvas.getContext('2d');
        if (!ctx) {
          console.warn('Context 2D untuk #overallStatsChart tidak bisa diambil');
          return;
        }
        const table = document.getElementById('compare-stats-table');
        if (!table) return;
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        const labels = [];
        const ttnData = [];
        const csvData = [];
        rows.forEach(row => {
          const tds = row.querySelectorAll('td');
          if (tds.length >= 3) {
            labels.push(tds[0].textContent.trim());
            const ttnVal = parseFloat((tds[1].textContent.trim().split('±')[0] || '').replace(',', '.'));
            const csvVal = parseFloat((tds[2].textContent.trim().split('±')[0] || '').replace(',', '.'));
            ttnData.push(isNaN(ttnVal) ? null : ttnVal);
            csvData.push(isNaN(csvVal) ? null : csvVal);
          }
        });
        if (window.overallStatsChartObj) window.overallStatsChartObj.destroy();
        const chartData = labels.length > 0 ? {
          labels: labels,
          datasets: [
            { label: 'TTN', data: ttnData, backgroundColor: '#2d8cf0' },
            { label: 'Chirpstack', data: csvData, backgroundColor: '#f5c542' }
          ]
        } : {
          labels: ['Tidak ada data'],
          datasets: [
            { label: 'TTN', data: [0], backgroundColor: '#2d8cf0' },
            { label: 'Chirpstack', data: [0], backgroundColor: '#f5c542' }
          ]
        };
        window.overallStatsChartObj = new Chart(ctx, {
          type: 'bar',
          data: chartData,
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Statistik Deskriptif Keseluruhan' }
            },
            scales: { y: { beginAtZero: false } }
          }
        });
      }

      // Grafik Distribusi Spreading Factor Keseluruhan
      function renderOverallSFChart() {
        const canvas = document.getElementById('overallSFChart');
        if (!canvas) {
          console.warn('Canvas #overallSFChart tidak ditemukan');
          return;
        }
        const ctx = canvas.getContext('2d');
        if (!ctx) {
          console.warn('Context 2D untuk #overallSFChart tidak bisa diambil');
          return;
        }
        const table = document.getElementById('compare-sf-table');
        if (!table) return;
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        const platforms = [];
        const sf7 = [], sf8 = [], sf10 = [];
        rows.forEach(row => {
          const tds = row.querySelectorAll('td');
          if (tds.length >= 4) {
            platforms.push(tds[0].textContent.trim());
            sf7.push(Number((tds[1].textContent.trim().split('(')[0] || '0').replace(',', '.')));
            sf8.push(Number((tds[2].textContent.trim().split('(')[0] || '0').replace(',', '.')));
            sf10.push(Number((tds[3].textContent.trim().split('(')[0] || '0').replace(',', '.')));
          }
        });
        if (window.overallSFChartObj) window.overallSFChartObj.destroy();
        const chartData = platforms.length > 0 ? {
          labels: platforms,
          datasets: [
            { label: 'SF7 (%)', data: sf7, backgroundColor: '#2d8cf0' },
            { label: 'SF8 (%)', data: sf8, backgroundColor: '#8cd0fa' },
            { label: 'SF10 (%)', data: sf10, backgroundColor: '#b0e0ff' }
          ]
        } : {
          labels: ['Tidak ada data'],
          datasets: [
            { label: 'SF7 (%)', data: [0], backgroundColor: '#2d8cf0' },
            { label: 'SF8 (%)', data: [0], backgroundColor: '#8cd0fa' },
            { label: 'SF10 (%)', data: [0], backgroundColor: '#b0e0ff' }
          ]
        };
        window.overallSFChartObj = new Chart(ctx, {
          type: 'bar',
          data: chartData,
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Distribusi Spreading Factor Keseluruhan (%)' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: { 
              y: { 
                beginAtZero: true, 
                min: 0, 
                max: 100, 
                title: { display: true, text: 'Persentase (%)' } 
              } 
            }
          },
          plugins: [ChartDataLabels]
        });
      }

      // --- Tambahkan fungsi render untuk masing-masing grafik Statistik Deskriptif Keseluruhan ---
      function renderOverallPDRChart() {
        const canvas = document.getElementById('overallPDRChart');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const table = document.getElementById('compare-stats-table');
        if (!table) return;
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        // Ambil baris PDR (baris pertama)
        if (rows.length < 1) return;
        const tds = rows[0].querySelectorAll('td');
        if (tds.length < 3) return;
        const labels = ['TTN', 'Chirpstack'];
        const ttnVal = parseFloat((tds[1].textContent.trim().split(' ')[0] || '').replace(',', '.'));
        const csvVal = parseFloat((tds[2].textContent.trim().split(' ')[0] || '').replace(',', '.'));
        const data = [
          isNaN(ttnVal) ? 0 : ttnVal,
          isNaN(csvVal) ? 0 : csvVal
        ];
        if (window.overallPDRChartObj) window.overallPDRChartObj.destroy();
        window.overallPDRChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              { label: 'PDR (%)', data: data, backgroundColor: ['#2d8cf0', '#f5c542'] }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: { display: true, text: 'PDR (%) Keseluruhan' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'PDR (%)' } } }
          },
          plugins: [ChartDataLabels]
        });
      }
      function renderOverallRSSIChart() {
        const canvas = document.getElementById('overallRSSIChart');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const table = document.getElementById('compare-stats-table');
        if (!table) return;
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        // Ambil baris RSSI (baris kedua)
        if (rows.length < 2) return;
        const tds = rows[1].querySelectorAll('td');
        if (tds.length < 3) return;
        const labels = ['TTN', 'Chirpstack'];
        const ttnVal = parseFloat((tds[1].textContent.trim().split('±')[0] || '').replace(',', '.'));
        const csvVal = parseFloat((tds[2].textContent.trim().split('±')[0] || '').replace(',', '.'));
        const data = [
          isNaN(ttnVal) ? 0 : ttnVal,
          isNaN(csvVal) ? 0 : csvVal
        ];
        if (window.overallRSSIChartObj) window.overallRSSIChartObj.destroy();
        window.overallRSSIChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              { label: 'RSSI (dBm)', data: data, backgroundColor: ['#2d8cf0', '#f5c542'] }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: { display: true, text: 'RSSI Rata-rata Keseluruhan (dBm)' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: { 
              y: { 
                beginAtZero: false, 
                min: -120, 
                max: -20, 
                title: { display: true, text: 'RSSI (dBm)' } 
              } 
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      function renderOverallSNRChart() {
        const canvas = document.getElementById('overallSNRChart');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const table = document.getElementById('compare-stats-table');
        if (!table) return;
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        // Ambil baris SNR (baris ketiga)
        if (rows.length < 3) return;
        const tds = rows[2].querySelectorAll('td');
        if (tds.length < 3) return;
        const labels = ['TTN', 'Chirpstack'];
        const ttnVal = parseFloat((tds[1].textContent.trim().split('±')[0] || '').replace(',', '.'));
        const csvVal = parseFloat((tds[2].textContent.trim().split('±')[0] || '').replace(',', '.'));
        const data = [
          isNaN(ttnVal) ? 0 : ttnVal,
          isNaN(csvVal) ? 0 : csvVal
        ];
        if (window.overallSNRChartObj) window.overallSNRChartObj.destroy();
        window.overallSNRChartObj = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              { label: 'SNR (dB)', data: data, backgroundColor: ['#2d8cf0', '#f5c542'] }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              title: { display: true, text: 'SNR Rata-rata Keseluruhan (dB)' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: { 
              y: { 
                beginAtZero: false, 
                min: -20, 
                max: 20, 
                title: { display: true, text: 'SNR (dB)' } 
              } 
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      function renderOverallSFChart() {
        const canvas = document.getElementById('overallSFChart');
        if (!canvas) {
          console.warn('Canvas #overallSFChart tidak ditemukan');
          return;
        }
        const ctx = canvas.getContext('2d');
        if (!ctx) {
          console.warn('Context 2D untuk #overallSFChart tidak bisa diambil');
          return;
        }
        const table = document.getElementById('compare-sf-table');
        if (!table) return;
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        const platforms = [];
        const sf7 = [], sf8 = [], sf10 = [];
        rows.forEach(row => {
          const tds = row.querySelectorAll('td');
          if (tds.length >= 4) {
            platforms.push(tds[0].textContent.trim());
            sf7.push(Number((tds[1].textContent.trim().split('(')[0] || '0').replace(',', '.')));
            sf8.push(Number((tds[2].textContent.trim().split('(')[0] || '0').replace(',', '.')));
            sf10.push(Number((tds[3].textContent.trim().split('(')[0] || '0').replace(',', '.')));
          }
        });
        if (window.overallSFChartObj) window.overallSFChartObj.destroy();
        const chartData = platforms.length > 0 ? {
          labels: platforms,
          datasets: [
            { label: 'SF7 (%)', data: sf7, backgroundColor: '#2d8cf0' },
            { label: 'SF8 (%)', data: sf8, backgroundColor: '#8cd0fa' },
            { label: 'SF10 (%)', data: sf10, backgroundColor: '#b0e0ff' }
          ]
        } : {
          labels: ['Tidak ada data'],
          datasets: [
            { label: 'SF7 (%)', data: [0], backgroundColor: '#2d8cf0' },
            { label: 'SF8 (%)', data: [0], backgroundColor: '#8cd0fa' },
            { label: 'SF10 (%)', data: [0], backgroundColor: '#b0e0ff' }
          ]
        };
        window.overallSFChartObj = new Chart(ctx, {
          type: 'bar',
          data: chartData,
          options: {
            responsive: true,
            plugins: {
              legend: { position: 'top' },
              title: { display: true, text: 'Distribusi Spreading Factor Keseluruhan (%)' },
              datalabels: {
                anchor: 'end',
                align: 'end',
                color: '#222',
                font: { weight: 'bold' },
                formatter: function(value) {
                  return value !== null && value !== undefined ? value : '';
                }
              }
            },
            scales: { 
              y: { 
                beginAtZero: true, 
                min: 0, 
                max: 100, 
                title: { display: true, text: 'Persentase (%)' } 
              } 
            }
          },
          plugins: [ChartDataLabels]
        });
      }
      // Ubah updateOverallCharts agar memanggil ketiga fungsi di atas
      if (typeof window.updateOverallCharts !== 'function') {
        window.updateOverallCharts = function() {
          renderOverallPDRChart();
          renderOverallRSSIChart();
          renderOverallSNRChart();
          renderOverallSFChart();
        };
      } else {
        // Jika sudah ada, override agar memanggil fungsi baru
        window.updateOverallCharts = function() {
          renderOverallPDRChart();
          renderOverallRSSIChart();
          renderOverallSNRChart();
          renderOverallSFChart();
        };
      }
      // --- DEBUG: Render ulang grafik setiap kali tabel berubah (MutationObserver) ---
      function observeTableAndRender(tableId, renderFn) {
        const table = document.getElementById(tableId);
        if (!table) return;
        const observer = new MutationObserver(() => {
          renderFn();
        });
        observer.observe(table.tBodies[0], { childList: true, subtree: true });
      }
      document.addEventListener('DOMContentLoaded', function() {
        window.updateOverallCharts();
        observeTableAndRender('compare-stats-table', function() {
          renderOverallPDRChart();
          renderOverallRSSIChart();
          renderOverallSNRChart();
        });
        observeTableAndRender('compare-sf-table', renderOverallSFChart);
      });
    </script>
</body>
</html>
<!-- Semua program grafik Chart.js sudah terhubung dan update otomatis.
     Tidak ada perubahan yang diperlukan. -->